<div class="container mx-auto px-4 py-6">
  <!-- Header -->
  <div class="mb-6">
    <%= link_to @trip, class: "text-primary-accent hover:text-blue-400 font-medium flex items-center group mb-4" do %>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 transform group-hover:-translate-x-1 transition-transform" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
      </svg> Back to <%= @trip.name %>
    <% end %>
    <h1 class="text-3xl font-bold text-text-primary">
      Manage Invitations
    </h1>
    <p class="text-text-secondary mt-2">View and manage trip invitations</p>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Pending Invitations -->
    <div class="bg-background-secondary rounded-2xl shadow-sm p-6">
      <h2 class="text-xl font-bold text-text-primary mb-6 flex items-center">
        ‚è≥ Pending Invitations
        <span class="ml-2 bg-accent-yellow text-white text-sm px-2 py-1 rounded-full">
          <%= @pending_invitations.count %>
        </span>
      </h2>
      
      <% if @pending_invitations.any? %>
        <div class="space-y-4">
          <% @pending_invitations.each do |invitation| %>
            <div class="bg-background-primary rounded-lg border border-gray-200 p-4">
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <div class="font-medium text-text-primary"><%= invitation.email %></div>
                  <div class="text-sm text-text-secondary mt-1">
                    Role: <%= invitation.role == 'admin' ? 'üëë Admin' : (invitation.role == 'member' ? 'üë§ Member' : 'üëÄ Guest (Read-Only)') %>
                  </div>
                  <div class="text-xs text-text-secondary mt-1">
                    Invited <%= time_ago_in_words(invitation.created_at) %> ago by <%= invitation.invited_by.email_address %>
                  </div>
                  <div class="text-xs text-accent-yellow mt-1">
                    Expires in <%= time_ago_in_words(invitation.expires_at) %>
                  </div>
                </div>
                <div class="ml-4 flex space-x-2">
                  <button class="text-primary-accent hover:text-blue-400 text-sm" 
                          onclick="copyToClipboard('<%= invitation_url(invitation.token) %>')">
                    üìã Copy Link
                  </button>
                  <%= link_to trip_invitation_path(@trip, invitation), 
                      data: { method: :delete, confirm: "Cancel this invitation? #{invitation.email} will no longer be able to join." },
                      class: "text-accent-red hover:text-red-700 text-sm" do %>
                    üóëÔ∏è Cancel
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8 text-text-secondary">
          <div class="text-4xl mb-3">üì≠</div>
          <p>No pending invitations</p>
        </div>
      <% end %>
    </div>

    <!-- Accepted Invitations -->
    <div class="bg-background-secondary rounded-2xl shadow-sm p-6">
      <h2 class="text-xl font-bold text-text-primary mb-6 flex items-center">
        ‚úÖ Accepted Invitations
        <span class="ml-2 bg-accent-green text-white text-sm px-2 py-1 rounded-full">
          <%= @accepted_invitations.count %>
        </span>
      </h2>
      
      <% if @accepted_invitations.any? %>
        <div class="space-y-4">
          <% @accepted_invitations.each do |invitation| %>
            <div class="bg-background-primary rounded-lg border border-gray-200 p-4">
              <div class="font-medium text-text-primary"><%= invitation.email %></div>
              <div class="text-sm text-text-secondary mt-1">
                Role: <%= invitation.role == 'admin' ? 'üëë Admin' : (invitation.role == 'member' ? 'üë§ Member' : 'üëÄ Guest (Read-Only)') %>
              </div>
              <div class="text-xs text-text-secondary mt-1">
                Accepted <%= time_ago_in_words(invitation.updated_at) %> ago
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8 text-text-secondary">
          <div class="text-4xl mb-3">üë•</div>
          <p>No accepted invitations yet</p>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Send New Invitation -->
  <div class="mt-8 text-center">
    <%= link_to new_trip_invitation_path(@trip), 
        class: "bg-primary-accent text-white px-6 py-3 rounded-xl font-bold hover:bg-blue-400 transition-all duration-200 shadow-md inline-flex items-center" do %>
      <span class="mr-2">üíå</span> Send New Invitation
    <% end %>
  </div>
</div>

<script>
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(function() {
    // You could add a toast notification here
    alert('Invitation link copied to clipboard!');
  }, function(err) {
    console.error('Could not copy text: ', err);
  });
}
</script>