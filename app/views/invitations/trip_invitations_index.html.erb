<div class="container mx-auto px-4 py-6">
  <!-- Header -->
  <div class="mb-6">
    <%= link_to @trip, class: "text-purple-700 hover:text-purple-900 font-medium flex items-center group mb-4" do %>
      <span class="transform group-hover:-translate-x-1 transition-transform mr-2">üë•</span> Back to <%= @trip.name %>
    <% end %>
    <h1 class="text-3xl font-bold bg-gradient-to-r from-purple-800 to-pink-700 bg-clip-text text-transparent">
      Manage Invitations
    </h1>
    <p class="text-purple-700 mt-2">View and manage trip invitations</p>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Pending Invitations -->
    <div class="bg-gradient-to-r from-white to-yellow-50 rounded-2xl shadow-lg border border-yellow-200 p-6">
      <h2 class="text-xl font-bold text-yellow-900 mb-6 flex items-center">
        ‚è≥ Pending Invitations
        <span class="ml-2 bg-yellow-200 text-yellow-800 text-sm px-2 py-1 rounded-full">
          <%= @pending_invitations.count %>
        </span>
      </h2>
      
      <% if @pending_invitations.any? %>
        <div class="space-y-4">
          <% @pending_invitations.each do |invitation| %>
            <div class="bg-white rounded-lg border border-yellow-300 p-4">
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <div class="font-medium text-gray-900"><%= invitation.email %></div>
                  <div class="text-sm text-gray-600 mt-1">
                    Role: <%= invitation.role == 'admin' ? 'üëë Admin' : 'üë§ Member' %>
                  </div>
                  <div class="text-xs text-gray-500 mt-1">
                    Invited <%= time_ago_in_words(invitation.created_at) %> ago by <%= invitation.invited_by.email_address %>
                  </div>
                  <div class="text-xs text-yellow-600 mt-1">
                    Expires in <%= time_ago_in_words(invitation.expires_at) %>
                  </div>
                </div>
                <div class="ml-4 flex space-x-2">
                  <button class="text-blue-600 hover:text-blue-800 text-sm" 
                          onclick="copyToClipboard('<%= invitation_url(invitation.token) %>')">
                    üìã Copy Link
                  </button>
                  <%= link_to trip_invitation_path(@trip, invitation), 
                      method: :delete,
                      data: { confirm: "Cancel this invitation? #{invitation.email} will no longer be able to join." },
                      class: "text-red-600 hover:text-red-800 text-sm" do %>
                    üóëÔ∏è Cancel
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8 text-yellow-700">
          <div class="text-4xl mb-3">üì≠</div>
          <p>No pending invitations</p>
        </div>
      <% end %>
    </div>

    <!-- Accepted Invitations -->
    <div class="bg-gradient-to-r from-white to-green-50 rounded-2xl shadow-lg border border-green-200 p-6">
      <h2 class="text-xl font-bold text-green-900 mb-6 flex items-center">
        ‚úÖ Accepted Invitations
        <span class="ml-2 bg-green-200 text-green-800 text-sm px-2 py-1 rounded-full">
          <%= @accepted_invitations.count %>
        </span>
      </h2>
      
      <% if @accepted_invitations.any? %>
        <div class="space-y-4">
          <% @accepted_invitations.each do |invitation| %>
            <div class="bg-white rounded-lg border border-green-300 p-4">
              <div class="font-medium text-gray-900"><%= invitation.email %></div>
              <div class="text-sm text-gray-600 mt-1">
                Role: <%= invitation.role == 'admin' ? 'üëë Admin' : 'üë§ Member' %>
              </div>
              <div class="text-xs text-gray-500 mt-1">
                Accepted <%= time_ago_in_words(invitation.updated_at) %> ago
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="text-center py-8 text-green-700">
          <div class="text-4xl mb-3">üë•</div>
          <p>No accepted invitations yet</p>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Send New Invitation -->
  <div class="mt-8 text-center">
    <%= link_to new_trip_invitation_path(@trip), 
        class: "bg-gradient-to-r from-purple-600 to-pink-600 text-white px-6 py-3 rounded-xl font-bold hover:from-purple-700 hover:to-pink-700 transition-all duration-200 shadow-lg inline-flex items-center" do %>
      <span class="mr-2">üíå</span> Send New Invitation
    <% end %>
  </div>
</div>

<script>
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(function() {
    // You could add a toast notification here
    alert('Invitation link copied to clipboard!');
  }, function(err) {
    console.error('Could not copy text: ', err);
  });
}
</script>