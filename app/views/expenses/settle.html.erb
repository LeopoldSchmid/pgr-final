<% content_for :title, "Settle Up - #{@trip.name}" %>

<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-bold text-text-primary">Settle Up</h1>
  </div>

  <!-- Your Balance -->
  <div class="bg-background-secondary rounded-xl p-6 shadow-lg mb-6">
    <h2 class="text-sm font-medium text-text-secondary mb-2">Your Balance</h2>
    <% if @user_balance && @user_balance != 0 %>
      <p class="text-3xl font-bold <%= @user_balance > 0 ? 'text-green-500' : 'text-red-500' %>">
        <%= number_to_currency(@user_balance.abs, precision: 2) %>
      </p>
      <p class="text-sm text-text-secondary mt-1">
        <% if @user_balance > 0 %>
          You are owed
        <% else %>
          You owe
        <% end %>
      </p>
    <% else %>
      <p class="text-3xl font-bold text-green-500">All settled up!</p>
      <p class="text-sm text-text-secondary mt-1">No outstanding balances</p>
    <% end %>
  </div>

  <!-- Settlement Suggestions -->
  <% if @settlement_suggestions.present? && @settlement_suggestions.any? %>
    <div class="bg-background-secondary rounded-xl p-6 shadow-lg">
      <h2 class="text-lg font-semibold text-text-primary mb-4">Suggested Payments</h2>
      <div class="space-y-3">
        <% @settlement_suggestions.each do |suggestion| %>
          <div class="flex items-center justify-between p-4 bg-background-primary/50 rounded-lg">
            <div class="flex items-center space-x-3">
              <%= user_avatar(suggestion[:from], size: 10) %>
              <div>
                <p class="text-sm font-medium text-text-primary">
                  <%= suggestion[:from].email_address %>
                </p>
                <p class="text-xs text-text-secondary">pays</p>
              </div>
            </div>
            <div class="text-center px-4">
              <p class="text-xl font-bold text-primary-accent">
                <%= number_to_currency(suggestion[:amount], precision: 2) %>
              </p>
            </div>
            <div class="flex items-center space-x-3">
              <div class="text-right">
                <p class="text-xs text-text-secondary">to</p>
                <p class="text-sm font-medium text-text-primary">
                  <%= suggestion[:to].email_address %>
                </p>
              </div>
              <%= user_avatar(suggestion[:to], size: 10) %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <div class="bg-background-secondary rounded-xl p-12 text-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-green-500 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <h2 class="text-xl font-semibold text-text-primary mb-2">All Settled!</h2>
      <p class="text-text-secondary">No payments needed</p>
    </div>
  <% end %>
</div>
