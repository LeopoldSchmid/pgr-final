<div class="container mx-auto px-4 py-6">

  <!-- Compact Stats & Actions -->
  <div class="bg-background-secondary rounded-xl shadow-sm p-4 mb-4">
    <div class="flex items-center justify-between mb-3">
      <div class="flex items-center space-x-6 text-sm">
        <div>Total: <span class="font-bold text-text-primary"><%= "%.2f" % @total_expenses %> EUR</span></div>
        <div>Balance: <span class="font-bold <%= @user_balance >= 0 ? 'text-green-600' : 'text-red-600' %>"><%= @user_balance >= 0 ? '+' : '' %><%= "%.2f" % @user_balance %> EUR</span></div>
        <div><%= @expenses.count %> expenses</div>
      </div>
    </div>
    
    <% if @settlement_suggestions.any? %>
      <div class="text-sm text-green-700 border-t border-gray-200 pt-2">
        üí∏ <strong>Settlements:</strong>
        <% @settlement_suggestions.each do |suggestion| %>
          <span class="ml-2"><%= suggestion[:from].email_address.split('@').first %> owes <%= suggestion[:to].email_address.split('@').first %> <%= "%.2f" % suggestion[:amount] %> EUR</span>
        <% end %>
      </div>
    <% end %>
  </div>

  <!-- Expenses List -->
    
  <div class="space-y-2">
    <% if @expenses.any? %>
      <% @expenses.each do |expense| %>
        <div class="bg-background-secondary rounded-lg shadow-sm p-4">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3 flex-1 min-w-0">
              <div class="text-lg"><%= expense.category_emoji %></div>
              <div class="flex-1 min-w-0">
                <h4 class="font-medium text-text-primary truncate"><%= expense.description %></h4>
                <div class="text-xs text-text-secondary">
                  <%= expense.payer.email_address.split('@').first %> ‚Ä¢ <%= expense.expense_date.strftime("%b %d") %> ‚Ä¢ <%= expense.participants.count %> people
                </div>
              </div>
            </div>
            <div class="text-right flex items-center space-x-3">
              <div class="font-bold text-text-primary">
                <%= expense.formatted_amount %>
              </div>
              <% if @trip.user_can_manage_expenses?(Current.user) %>
                <div class="flex space-x-1">
                  <%= link_to edit_expense_path(expense), 
                      class: "text-primary-accent hover:text-blue-600 text-sm" do %>
                    ‚úèÔ∏è
                  <% end %>
                  <%= link_to trip_expense_path(@trip, expense), 
                      data: { turbo_method: :delete, turbo_confirm: "Delete this expense?" },
                      class: "text-red-600 hover:text-red-800 text-sm" do %>
                    üóëÔ∏è
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    <% else %>
      <!-- Empty State -->
      <div class="bg-background-secondary rounded-2xl shadow-lg p-12 text-center">
        <div class="text-6xl mb-4 opacity-60">üí∞</div>
        <h3 class="text-xl font-bold text-text-primary mb-3">No Expenses Yet</h3>
        <%= link_to new_expense_path, 
            class: "inline-flex items-center bg-primary-accent text-background-primary px-6 py-3 rounded-xl font-bold hover:bg-blue-600 transition-all duration-200 shadow-lg hover:shadow-md" do %>
          <span class="mr-2">‚ûï</span> Add First Expense
        <% end %>
      </div>
    <% end %>
  </div>
</div>
