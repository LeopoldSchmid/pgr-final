<div class="container mx-auto px-4 py-6">
  <!-- Navigation Context Indicator -->
  <%= navigation_context_indicator.html_safe if navigation_context_indicator %>
  
  <!-- Trip Header -->
  <div class="bg-background-secondary rounded-2xl shadow-lg p-6 mb-6">
    <div class="mb-4">
      <%= link_to go_path, class: "text-primary-accent hover:text-yellow-400 font-medium flex items-center group mb-3" do %>
        <span class="transform group-hover:-translate-x-1 transition-transform mr-2">‚Üê</span> Active Trips
      <% end %>
      <h1 class="text-2xl font-bold text-text-primary">
        <%= @trip.name %>
      </h1>
    </div>
    
    <div class="flex items-center space-x-3 text-sm">
      <span class="bg-primary-accent text-background-primary px-3 py-1 rounded-lg font-medium">
        Active
      </span>
      <% if @trip.start_date && @trip.end_date %>
        <span class="text-text-secondary">
          <%= @trip.start_date.strftime("%b %d") %> - <%= @trip.end_date.strftime("%b %d, %Y") %>
        </span>
      <% end %>
      <span class="text-text-secondary">
        Day <%= (@trip.start_date ? (Date.current - @trip.start_date).to_i + 1 : 1) %>
      </span>
    </div>
  </div>

  <!-- Actions Grid -->
  <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
    
    <!-- Capture Moment -->
    <%= link_to capture_trip_path(@trip), class: "bg-background-secondary rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow" do %>
      <div class="text-center">
        <div class="text-2xl mb-2">üìù</div>
        <div class="text-sm font-medium text-text-primary">Capture Moment</div>
        <div class="text-xs text-text-secondary">Add memory</div>
      </div>
    <% end %>

    <!-- View Journal -->
    <%= link_to journal_trip_path(@trip), class: "bg-background-secondary rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow" do %>
      <div class="text-center">
        <div class="text-2xl mb-2">üìñ</div>
        <div class="text-sm font-medium text-text-primary">Trip Journal</div>
        <div class="text-xs text-text-secondary"><%= @journal_entries.count %> entries</div>
      </div>
    <% end %>

    <!-- Memory Map -->
    <% if @journal_entries.with_location.any? %>
      <%= link_to map_trip_path(@trip), class: "bg-background-secondary rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow" do %>
        <div class="text-center">
          <div class="text-2xl mb-2">üó∫Ô∏è</div>
          <div class="text-sm font-medium text-text-primary">Memory Map</div>
          <div class="text-xs text-text-secondary"><%= @journal_entries.with_location.count %> locations</div>
        </div>
      <% end %>
    <% else %>
      <div class="bg-gray-100 rounded-xl p-4 opacity-50">
        <div class="text-center">
          <div class="text-2xl mb-2">üó∫Ô∏è</div>
          <div class="text-sm font-medium text-gray-500">Memory Map</div>
          <div class="text-xs text-gray-400">No locations yet</div>
        </div>
      </div>
    <% end %>

    <!-- Gallery -->
    <% images_count = @journal_entries.joins(:images_attachments).count %>
    <% if images_count > 0 %>
      <%= link_to gallery_trip_path(@trip), class: "bg-background-secondary rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow" do %>
        <div class="text-center">
          <div class="text-2xl mb-2">üì∏</div>
          <div class="text-sm font-medium text-text-primary">Gallery</div>
          <div class="text-xs text-text-secondary"><%= images_count %> photos</div>
        </div>
      <% end %>
    <% else %>
      <div class="bg-gray-100 rounded-xl p-4 opacity-50">
        <div class="text-center">
          <div class="text-2xl mb-2">üì∏</div>
          <div class="text-sm font-medium text-gray-500">Gallery</div>
          <div class="text-xs text-gray-400">No photos yet</div>
        </div>
      </div>
    <% end %>

  </div>

  <!-- Quick Actions -->
  <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
    
    <!-- Expenses -->
    <%= link_to trip_expenses_path(@trip), class: "bg-background-secondary rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow" do %>
      <div class="text-center">
        <div class="text-2xl mb-2">üí∞</div>
        <div class="text-sm font-medium text-text-primary">Expenses</div>
        <div class="text-xs text-text-secondary">Track spending</div>
      </div>
    <% end %>

    <!-- Add Expense -->
    <%= link_to new_trip_expense_path(@trip), class: "bg-background-secondary rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow" do %>
      <div class="text-center">
        <div class="text-2xl mb-2">+</div>
        <div class="text-sm font-medium text-text-primary">Add Expense</div>
        <div class="text-xs text-text-secondary">Log purchase</div>
      </div>
    <% end %>

    <!-- Check List -->
    <button class="bg-background-secondary rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow">
      <div class="text-center">
        <div class="text-2xl mb-2">‚úì</div>
        <div class="text-sm font-medium text-text-secondary">Check List</div>
        <div class="text-xs text-text-secondary">Coming soon</div>
      </div>
    </button>

    <!-- Reminders -->
    <button class="bg-background-secondary rounded-xl p-4 shadow-sm hover:shadow-md transition-shadow">
      <div class="text-center">
        <div class="text-2xl mb-2">‚è∞</div>
        <div class="text-sm font-medium text-text-secondary">Reminder</div>
        <div class="text-xs text-text-secondary">Coming soon</div>
      </div>
    </button>

  </div>

  <!-- Recent Activity Summary -->
  <% if @journal_entries.recent.limit(3).any? %>
    <div class="bg-background-secondary rounded-xl p-4 mb-6">
      <h3 class="text-lg font-semibold text-text-primary mb-3">Recent Activity</h3>
      <div class="space-y-2">
        <% @journal_entries.recent.limit(3).each do |entry| %>
          <div class="flex items-center space-x-3 text-sm">
            <div class="w-2 h-2 bg-primary-accent rounded-full"></div>
            <div class="flex-1">
              <span class="text-text-primary"><%= truncate(entry.content, length: 60) %></span>
              <span class="text-text-secondary">‚Ä¢ <%= time_ago_in_words(entry.created_at) %> ago</span>
            </div>
          </div>
        <% end %>
      </div>
      <%= link_to "View all entries ‚Üí", journal_trip_path(@trip), class: "text-primary-accent text-sm hover:underline mt-2 inline-block" %>
    </div>
  <% end %>

  <!-- Trip Actions -->
  <div class="text-center">
    <button class="bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 transition-colors text-sm">
      End Trip
    </button>
  </div>

</div>